<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Détail véhicule — E.V.H. AUTOTRADE</title>
  <link rel="stylesheet" href="styles.css?v=10">
</head>
<body class="page-vehicle">
  <!-- Header v10 -->
  <header>
    <div class="logo-wrap">
      <div class="logo">
        <img src="images/EVH_logo.png" alt="E.V.H. AUTOTRADE">
      </div>
      <div class="brand">
        <span class="evh">E.V.H.</span>
        <span class="autotrade">AUTOTRADE</span>
      </div>
    </div>
    <nav>
      <ul>
        <li><a href="index.html">Accueil</a></li>
        <li><a href="index.html#vehicles-grid">Catalogue</a></li>
        <li><a href="index.html#avantages">Avantages</a></li>
        <li><a href="#">Acheter</a></li>
        <li><a href="#">À propos</a></li>
        <li><a href="#">Contact</a></li>
      </ul>
    </nav>
  </header>

  <div class="container">
    <a href="index.html" class="back-link">← Retour au catalogue</a>
    <div id="vehicle-detail">
      <p>Chargement du véhicule…</p>
    </div>
  </div>

  <!-- Lightbox v10 -->
  <div id="lightbox" aria-hidden="true">
    <span id="close">✕</span>
    <span id="prev">‹</span>
    <img id="lbImg" alt="">
    <span id="next">›</span>
  </div>

  <script>
    const urlParams = new URLSearchParams(window.location.search);
    const vehicleId = urlParams.get('id');

    if (!vehicleId) {
      document.getElementById('vehicle-detail').innerHTML = `
        <div style="background:#fff3f3;color:#d32f2f;padding:2rem;border-radius:12px;text-align:center;">
          <h2>Erreur</h2>
          <p>Aucun véhicule sélectionné.</p>
          <a href="index.html" style="color:#e53e3e;text-decoration:none;font-weight:700;">← Retour au catalogue</a>
        </div>`;
    } else {
      fetch(\`data/details/\${vehicleId}.json\`)
        .then(res => { if(!res.ok) throw new Error('Fichier non trouvé'); return res.json(); })
        .then(data => {
          const mileage = new Intl.NumberFormat('fr-FR').format(data.mileage ?? 0);
          const year = (data.regyear || '').split('-')[0] || '—';

          // Build specs list (1 par ligne)
          const specs = data.specifications || {};
          const items = [];
          const add = (label, value) => { if (value) items.push({label, value}); };

          add('Moteur', specs.moteur || '-');
          add('Puissance moteur', specs.puissance || '-');
          add('Transmission', specs.transmission || '-');
          add('Traction', specs.traction || (data.features||[]).find(f=>/2wd|4wd|awd/i.test(f)) || '-');
          add('Autonomie électrique', specs.autonomieElectrique || '-');
          add('Type de carrosserie', specs.typeCarrosserie || 'SUV');
          add('Couleur', specs.couleur || data.couleur || '-');
          add('Places', specs.places || '5 places');
          if (specs.dimensions) {
            const dims = [specs.dimensions.longueur, specs.dimensions.largeur, specs.dimensions.hauteur].filter(Boolean).join(' × ');
            add('Dimensions (L×l×H)', dims);
          }
          if (specs.poids || specs.capaciteMax) {
            add('Poids / Capacité max', [specs.poids, specs.capaciteMax].filter(Boolean).join(' / '));
          }

          const specsHTML = item
